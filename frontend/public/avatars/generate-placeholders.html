<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Avatar Sprite Generator</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      background: #1a1a2e;
      color: white;
    }
    h1 { color: #8B5CF6; }
    .avatar-preview {
      margin: 20px 0;
      padding: 20px;
      background: #2a2a4e;
      border-radius: 8px;
    }
    .avatar-preview h3 { margin-top: 0; }
    canvas {
      display: block;
      margin: 10px 0;
      background: #000;
      border-radius: 4px;
    }
    button {
      background: #8B5CF6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin-right: 10px;
    }
    button:hover { background: #7C3AED; }
    .download-all {
      background: #10B981;
      font-size: 16px;
      padding: 12px 24px;
      margin-top: 20px;
    }
    .download-all:hover { background: #059669; }
    .instructions {
      background: #2a2a4e;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ­ Avatar Sprite Generator</h1>

  <div class="instructions">
    <p><strong>Instructions:</strong></p>
    <ol>
      <li>Click "Download All" to save all sprite sheets</li>
      <li>Place the downloaded PNG files in the <code>public/avatars/</code> folder</li>
      <li>The sprites will work with the dance floor animation system</li>
    </ol>
  </div>

  <button class="download-all" onclick="downloadAll()">ðŸ“¥ Download All Sprites</button>

  <div id="previews"></div>

  <script>
    const avatars = [
      { name: 'worshiper', frames: 8, color: '#8B5CF6', label: 'W' },
      { name: 'dancer', frames: 8, color: '#EC4899', label: 'D' },
      { name: 'singer', frames: 6, color: '#F59E0B', label: 'S' },
      { name: 'clapper', frames: 4, color: '#10B981', label: 'C' },
      { name: 'swayer', frames: 6, color: '#3B82F6', label: 'Y' },
      { name: 'jumper', frames: 8, color: '#EF4444', label: 'J' },
    ];

    const FRAME_SIZE = 64;

    function lightenColor(color, percent) {
      const num = parseInt(color.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.min(255, (num >> 16) + amt);
      const G = Math.min(255, ((num >> 8) & 0x00FF) + amt);
      const B = Math.min(255, (num & 0x0000FF) + amt);
      return `#${(1 << 24 | R << 16 | G << 8 | B).toString(16).slice(1)}`;
    }

    function darkenColor(color, percent) {
      const num = parseInt(color.replace('#', ''), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.max(0, (num >> 16) - amt);
      const G = Math.max(0, ((num >> 8) & 0x00FF) - amt);
      const B = Math.max(0, (num & 0x0000FF) - amt);
      return `#${(1 << 24 | R << 16 | G << 8 | B).toString(16).slice(1)}`;
    }

    function generateSpriteSheet(avatar) {
      const width = avatar.frames * FRAME_SIZE;
      const height = FRAME_SIZE;
      const canvas = document.createElement('canvas');
      canvas.width = width;
      canvas.height = height;
      const ctx = canvas.getContext('2d');

      for (let i = 0; i < avatar.frames; i++) {
        const x = i * FRAME_SIZE;
        const bounceOffset = Math.sin((i / avatar.frames) * Math.PI * 2) * 4;
        const scaleVariation = 1 + Math.sin((i / avatar.frames) * Math.PI * 2) * 0.05;

        const centerX = x + FRAME_SIZE / 2;
        const centerY = FRAME_SIZE / 2 + bounceOffset;
        const radius = 22 * scaleVariation;

        // Draw body
        const gradient = ctx.createRadialGradient(
          centerX - 3, centerY - 3, 0,
          centerX, centerY, radius
        );
        gradient.addColorStop(0, lightenColor(avatar.color, 30));
        gradient.addColorStop(1, avatar.color);

        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
        ctx.fillStyle = gradient;
        ctx.fill();

        ctx.strokeStyle = darkenColor(avatar.color, 20);
        ctx.lineWidth = 2;
        ctx.stroke();

        // Draw label
        ctx.fillStyle = '#FFFFFF';
        ctx.font = 'bold 18px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(avatar.label, centerX, centerY);

        // Draw arms
        ctx.strokeStyle = avatar.color;
        ctx.lineWidth = 4;
        ctx.lineCap = 'round';

        const armAngle = (i / avatar.frames) * Math.PI * 2;
        const leftArmY = centerY + Math.sin(armAngle) * 6;
        const rightArmY = centerY + Math.sin(armAngle + Math.PI) * 6;

        ctx.beginPath();
        ctx.moveTo(centerX - radius + 3, centerY);
        ctx.lineTo(centerX - radius - 8, leftArmY - 8);
        ctx.stroke();

        ctx.beginPath();
        ctx.moveTo(centerX + radius - 3, centerY);
        ctx.lineTo(centerX + radius + 8, rightArmY - 8);
        ctx.stroke();
      }

      return canvas;
    }

    function downloadCanvas(canvas, filename) {
      const link = document.createElement('a');
      link.download = filename;
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    function downloadAll() {
      avatars.forEach((avatar, index) => {
        setTimeout(() => {
          const canvas = generateSpriteSheet(avatar);
          downloadCanvas(canvas, `${avatar.name}.png`);
        }, index * 200);
      });
    }

    // Generate previews
    const previews = document.getElementById('previews');
    avatars.forEach(avatar => {
      const canvas = generateSpriteSheet(avatar);
      const div = document.createElement('div');
      div.className = 'avatar-preview';
      div.innerHTML = `
        <h3>${avatar.name}.png</h3>
        <p>${avatar.frames} frames Ã— 64px = ${avatar.frames * 64}px wide</p>
      `;
      div.appendChild(canvas);

      const btn = document.createElement('button');
      btn.textContent = `Download ${avatar.name}.png`;
      btn.onclick = () => downloadCanvas(canvas, `${avatar.name}.png`);
      div.appendChild(btn);

      previews.appendChild(div);
    });
  </script>
</body>
</html>
